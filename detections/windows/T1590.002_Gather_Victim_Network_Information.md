# [ATT&CK] Reconnaissance — Suspicious DNS Enumeration Activity (T1590.002)

**Platform:** Windows / Network  
**ATT&CK Technique:** T1590.002 — Gather Victim Network Information: DNS  
**Tactic(s):** Reconnaissance  
**Severity:** Medium  
**Data Sources:** Windows DNS Server Logs, Sysmon (NetworkConnect), Zeek / Suricata DNS Logs, Firewall Logs


## Detection Logic (SPL)
```spl
index=dns OR index=network_traffic
| search query IN ("*.local", "*.corp", "*.internal", "dc*", "_ldap._tcp*", "_kerberos*")
| stats count AS query_count, values(client_ip) AS src by query
| where query_count > 15
| sort -query_count
```
## Rationale 
Adversaries often perform DNS enumeration to discover internal domains, hosts, and Active Directory services
before attempting lateral movement. Frequent or systematic DNS queries for interal zones, LDAP SRV records, or domain
controller names may indicate automated reconnaissance or tools such as nslookup, dig, or dnsenum.

---

## Triage
- Identify the source IP(client) generating the suspicous volume of DNS queries.
- Check whether that system normally performs network scanning or discovery tasks.
- Look for other recon indicators from the same host (Network scans, LDAP queries, SMB connections).
- Validate if the requests target non-public domains (.local, .internal, .corp)

## Response
- Isolate or monitor the host performing enumeration to confirm intent.
- Correlate with authentication and system logs to determine if a compromised accoutn is involved
- If malicious, block outbound DNS traffic to sensitive zones and perform a full endpoint review for discovery scripts or malware.
- Alert network defenders to increase monitoring for similar DNS patterns across other subnets.

- 
