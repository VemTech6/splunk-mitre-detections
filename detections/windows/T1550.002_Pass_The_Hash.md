# [ATT&CK] Lateral Movement — Unusual Network Logons / Potential Pass-the-Hash (T1550.002)

**Platform:** Windows  
**ATT&CK Technique:** T1550.002 — Use of Valid Accounts: Pass the Hash  
**Tactic(s):** Lateral Movement, Credential Access  
**Severity:** High  
**Data Sources:** Windows Security (EventCode=4624, Logon_Type), Sysmon, Network Logs

## Detection Logic (SPL)
```spl
index=wineventlog sourcetype=WinEventLog:Security EventCode=4624
| eval LogonTypeDesc=case(Logon_Type==3,"Network",Logon_Type==9,"NewCredentials",true(),"Other")
| where Logon_Type IN (3,9)
| eval src=coalesce(IpAddress, Source_Network_Address)
| where isnotnull(src) AND src!="-"
| stats count AS attempts by src, TargetUserName, LogonTypeDesc, Computer, _time
| where attempts > 10
| sort -attempts
```
## Rationale 
This detection identifies a high volume of successful network logons (Type 3) or NewCredentials (Type 9) 
from the same source system. Such patterns may indicate lateral movement or Pass-the-Hash techniques,
where stolen credentials are reused across multiple endpoints.
Monitoring for abnormal authentication frequency helps detect credential misuse and unauthorized remote sessions.

## Triage
- Verify whether the source IP address is associated with a legitimate admin workstation or jump host.
- Review the TargetUserName and confirm whether this account usually authenticates from that source.
- Correlate with failed logons (EventCode=4625), Kerberos events (4768 / 4771), or service creation logs for additional indicators.
- Compare timing and frequency against normal authentication behavior for that account.

  ## Response
- Isolate affected systems or subnets if the pattern suggests credential compromise.
- Reset passwords or disable affected accounts immediately.
- Collect forensic artifacts (security logs, Sysmon data, registry hives) for further investigation.
- Conduct a full lateral movement sweep across the environment to identify other compromised hosts.

## Notes/False Positives
- Repeated network logons can be normal for system management, backup, or patching tools (e.g., SCCM, domain controllers).
- Verify automation accounts and scheduled service activity before raising an incident.
- Adjust the threshold (attempts > 10) based on baseline activity in your environment.






